<!DOCTYPE html>
<html>
<head>
    <title>LeetCode Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style id="theme-style">
        html, body {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
    </style>
</head>
<body>
<div class="container py-4">
    <div class="d-flex justify-content-end mb-2 gap-2">
        <button id="toggleTheme" class="btn btn-sm btn-dark">🌓 Dark Mode</button>
        <a href="/export" class="btn btn-outline-info">📥 Export CSV</a>
        <a href="/review-trend" class="btn btn-outline-success">📈 Review Trend</a>
        <a href="/due-today" class="btn btn-outline-warning">🧠 Due Today</a>
        <a href="/stats" class="btn btn-outline-info">📊 View Stats</a>
    </div>

    <h2 class="mb-4">💡 LeetCode Smart Tracker</h2>

    <!-- Add Problem Form -->
    <form action="/add" method="POST" class="card p-3 mb-4 shadow-sm">
        <div class="row g-2">
            <div class="col-md-4"><input class="form-control" type="text" name="title" placeholder="Problem Title" required></div>
            <div class="col-md-4"><input class="form-control" type="url" name="link" placeholder="LeetCode URL" required></div>
            <div class="col-md-2">
                <select name="difficulty" class="form-select">
                    <option>Easy</option>
                    <option>Medium</option>
                    <option>Hard</option>
                </select>
            </div>
            <div class="col-md-2"><button class="btn btn-primary w-100">Add</button></div>
        </div>
        <textarea class="form-control mt-2" name="notes" rows="2" placeholder="Optional Notes"></textarea>
    </form>

    <!-- Filter Buttons -->
    <div class="mb-3 d-flex gap-2">
        <a href="/" class="btn btn-outline-dark btn-sm">All</a>
        <a href="/filter/Easy" class="btn btn-outline-success btn-sm">Easy</a>
        <a href="/filter/Medium" class="btn btn-outline-warning btn-sm">Medium</a>
        <a href="/filter/Hard" class="btn btn-outline-danger btn-sm">Hard</a>
    </div>

    <!-- Search -->
    <input type="text" id="searchInput" class="form-control mb-3" placeholder="🔍 Search problems...">

    {% for p in problems %}
    <div class="card mb-3 shadow-sm">
        <div class="card-body">
           <h5 class="card-title">
           <a href="{{ p[2] }}" target="_blank"> 
           {{ p[1] }}  </a>
    <span class="badge bg-{{ color }} float-end">{{ p[3] }}</span>
         </h5>
            <p class="card-text">{{ p[4] }}</p>
            <p class="text-muted mb-1">📅 Last Reviewed: {{ p[6] }} | 🔁 Reviewed: {{ p[5] }} times</p>
            <p class="text-muted mb-2">🗓️ Next Review: {{ p[7] }}</p>
            <div class="d-flex gap-2">
                <form action="/review/{{ p[0] }}" method="POST">
                    <button class="btn btn-success btn-sm">✅ Mark as Reviewed</button>
                </form>
                <a href="/edit/{{ p[0] }}" class="btn btn-outline-primary btn-sm">✏️ Edit</a>
                <form action="/delete/{{ p[0] }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this problem?')">
                    <button class="btn btn-outline-danger btn-sm">🗑️ Delete</button>
                </form>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Search Function -->
<script>
document.getElementById("searchInput").addEventListener("keyup", function () {
    let filter = this.value.toLowerCase();
    let cards = document.querySelectorAll(".card");
    cards.forEach(function (card) {
        let text = card.innerText.toLowerCase();
        card.style.display = text.includes(filter) ? "" : "none";
    });
});
</script>

<!-- Dark Mode Toggle -->
<script>
const toggleBtn = document.getElementById("toggleTheme");
const styleTag = document.getElementById("theme-style");

function applyTheme(theme) {
    if (theme === "dark") {
        styleTag.innerHTML = `
            html, body { background-color: #121212; color: #e0e0e0; }
            .card { background-color: #1e1e1e; color: #e0e0e0; }
            .form-control, .form-select {
                background-color: #2b2b2b;
                color: #f0f0f0;
                border: 1px solid #444;
            }
            .btn-primary { background-color: #0d6efd; border-color: #0d6efd; color: white; }
            .btn-outline-primary { border-color: #90caf9; color: #90caf9; }
            .btn-outline-danger { border-color: #f48fb1; color: #f48fb1; }
            .btn-outline-success { border-color: #81c784; color: #81c784; }
            .btn-outline-warning { border-color: #ffb74d; color: #ffb74d; }
            .btn-outline-dark { border-color: #ccc; color: #ccc; }
            .btn-dark { background-color: #333; color: white; }
            a { color: #64b5f6; }
            .text-muted { color: #b0b0b0 !important; }
            input::placeholder, textarea::placeholder { color: #aaa; }
        `;
    } else {
        styleTag.innerHTML = `
            html, body { background-color: #f8f9fa; color: #212529; }
            .card { background-color: #fff; color: #212529; }
            .form-control, .form-select {
                background-color: #fff;
                color: #212529;
                border: 1px solid #ccc;
            }
            .btn-primary { background-color: #0d6efd; border-color: #0d6efd; color: white; }
            .btn-outline-primary { border-color: #0d6efd; color: #0d6efd; }
            .btn-outline-danger { border-color: #dc3545; color: #dc3545; }
            .btn-outline-success { border-color: #198754; color: #198754; }
            .btn-outline-warning { border-color: #ffc107; color: #ffc107; }
            .btn-outline-dark { border-color: #212529; color: #212529; }
            .btn-dark { background-color: #212529; color: white; }
            a { color: #0d6efd; }
            .text-muted { color: #6c757d !important; }
            input::placeholder, textarea::placeholder { color: #6c757d; }
        `;
    }
}

// Initialize theme on load
const savedTheme = localStorage.getItem("theme") || "light";
applyTheme(savedTheme);

// Toggle event
toggleBtn.addEventListener("click", () => {
    const current = localStorage.getItem("theme") || "light";
    const next = current === "dark" ? "light" : "dark";
    applyTheme(next);
    localStorage.setItem("theme", next);
});
</script>


</body>
</html>
